name: Web3 Backend CI

# ğŸ” NÃ¤r ska pipelinen kÃ¶ras?
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
      # 1ï¸âƒ£ Checka ut koden frÃ¥n GitHub-repot
      - name: ğŸ”„ Checkout koden
        uses: actions/checkout@v3

      # 2ï¸âƒ£ Installera rÃ¤tt Node-version
      - name: ğŸŸ¢ Installera Node.js
        uses: actions/setup-node@v3
        with:
          node-version: 18

      # 3ï¸âƒ£ Installera projektets dependencies (rot, dÃ¤r hardhat finns)
      - name: ğŸ“¦ Installera root dependencies
        run: npm install

      # 4ï¸âƒ£ Installera backend-API:t's egna dependencies
      - name: ğŸ“¦ Installera backend dependencies
        run: |
          cd backend
          npm install

      # 5ï¸âƒ£ Kompilera smarta kontrakt (mÃ¥ste kÃ¶ras i rotmappen)
      - name: ğŸ”¨ Kompilera smarta kontrakt
        run: |
          npx hardhat compile

      # 6ï¸âƒ£ KÃ¶r tester (t.ex. test/MyContract.test.js)
      - name: ğŸ§ª Testa smarta kontrakt
        run: |
          npx hardhat test
